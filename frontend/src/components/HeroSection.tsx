import React from 'react';
import { Link } from 'react-router-dom';
import { builder, Builder } from '@builder.io/react'; // Import Builder

// Define props interface for Builder.io
interface Props {
  title: string; // Using simple string, Builder will pass HTML from richText
  imageUrl: string;
  imageAlt: string;
  // Optional props
  buttonText?: string;
  buttonLink?: string;
  buttonBgColor?: string; // Tailwind bg class e.g., 'bg-destructive'
  buttonTextColor?: string; // Tailwind text class e.g., 'text-white'
  backgroundImageUrl?: string;
  backgroundColor?: string; // Tailwind bg class if no image e.g., 'bg-secondary'
  titleColor?: string; // Tailwind class e.g., 'text-white'
  reverseLayout?: boolean; // Add this line
  removeImage?: boolean; // Add this line
}

// Register component for props editing in Builder.io
// NOTE: Registration is now handled centrally in builderRegistry.ts
// builder.init("YOUR_API_KEY"); // Key init is done in App.tsx
// Builder.registerComponent(HeroSection, { ... }); // Moved to builderRegistry.ts

export const HeroSection = ({
  // Provide default values matching the original design
  title = "Transform lives,<br />one wish at a time.",
  imageUrl = "https://static.databutton.com/public/70b6a46a-5403-4152-84ce-6a9ec9a87a0f/Jaspers-Wish.webp",
  imageAlt = "Child receiving a wish",
  // Optional props with defaults or undefined
  buttonText,
  buttonLink,
  buttonBgColor = 'bg-destructive', // Default button bg
  buttonTextColor = 'text-destructive-foreground', // Default button text
  backgroundImageUrl,
  backgroundColor, // No default, relies on logic below
  titleColor = 'text-primary-foreground', // Default color if none provided
  reverseLayout = false, // Default layout
  removeImage = false, // Default show image
}: Props) => {

  const showButton = buttonText && buttonLink;
  const isCompact = removeImage && !showButton;

  const handleButtonClick = (event: React.MouseEvent<HTMLAnchorElement>) => {
    // Prevent navigation only if inside the Builder editor/preview
    if (Builder.isEditing || Builder.isPreviewing) {
      event.preventDefault();
      console.log("Hero button clicked (navigation prevented in Builder editor/preview). Link:", buttonLink);
    }
    // Allow normal navigation otherwise (Link component handles SPA routing)
  };

  // Determine section background class
  const sectionBgClass = backgroundImageUrl
    ? '' // Background image takes precedence
    : backgroundColor // Use custom color if provided
    ? backgroundColor
    : 'bg-primary'; // Default to primary blue if no image and no custom color

  return (
    // Apply dynamic background class, keep other styles
    <section 
      className={`relative ${sectionBgClass} text-primary-foreground pt-20 md:pt-24 ${isCompact ? 'pb-20' : 'pb-32'} bg-cover bg-center`}
      style={backgroundImageUrl ? { backgroundImage: `url(${backgroundImageUrl})` } : {}}
    >
      <div className="container mx-auto px-4">
        {/* Adjust flex direction and item alignment based on props */}
        <div className={`flex flex-col ${!removeImage && (reverseLayout ? 'md:flex-row-reverse' : 'md:flex-row')} items-center`}>
          {/* Left/Main Column: Text Content - Adjust width, padding and text alignment */}
          <div className={`${isCompact ? 'mb-0' : 'mb-10'} md:mb-0 ${removeImage ? 'md:w-full text-center' : `md:w-1/2 text-center md:text-left ${reverseLayout ? 'md:pl-12' : 'md:pr-12'}`}`}>
            {/* Use dangerouslySetInnerHTML for the title from Builder's richText */}
            <h1 
              className={`text-4xl md:text-5xl lg:text-6xl font-bold ${showButton ? 'mb-6' : 'mb-0'} ${titleColor}`}
              dangerouslySetInnerHTML={{ __html: title }} 
            />
            {
              /* Conditionally render button with dynamic colors and centering logic */
              showButton && (
                <div className={`mt-6 ${removeImage ? 'flex justify-center' : ''}`}> {/* Wrapper for centering button */}                  
                  <Link
                    to={buttonLink}
                    onClick={handleButtonClick} // Add click handler for editor preview
                    // Apply dynamic button background and text colors
                    className={`inline-block ${buttonBgColor} ${buttonTextColor} hover:opacity-90 font-medium px-8 py-3 rounded-full text-lg transition duration-300`}
                  >
                    {buttonText}
                  </Link>
                </div>
              )
            }
          </div>
          
          {/* Right/Image Column - Conditionally render based on removeImage */}
          {!removeImage && (
            <div className="md:w-1/2">
              <img 
                src={imageUrl} 
                alt={imageAlt} 
                className="rounded-lg shadow-xl w-full h-auto object-cover"
              />
            </div>
          )}
        </div>
      </div>
      {/* Star Decorations - Kept as is */}
      <div className="absolute top-10 left-10 w-16 h-16 text-primary-foreground opacity-10 transform rotate-12 pointer-events-none">
        <svg viewBox="0 0 1503 1492" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path fill="currentColor" d="M0.999994,663.000000 
	C1.000000,654.979065 1.000000,646.958191 1.367079,638.462708 
	C2.502623,637.243408 3.518604,636.631836 4.001655,635.733582 
	C9.439798,625.621216 17.701845,619.569946 28.931587,616.864014 
	C45.948551,612.763672 62.835785,608.121033 79.759155,603.637146 
	C105.609093,596.788269 131.434235,589.845825 157.286087,583.004272 
	C178.129517,577.488220 199.006027,572.097168 219.851471,566.588623 
	C245.705734,559.756409 271.533600,552.824219 297.390747,546.002991 
	C319.492981,540.172180 341.630341,534.474548 363.734192,528.649780 
	C389.751038,521.793884 415.728149,514.786682 441.761566,507.994720 
	C458.285431,503.683807 474.881348,499.703156 488.221344,487.982971 
	C497.447632,479.876953 505.352722,470.707794 509.916931,459.240448 
	C513.625549,449.922791 516.577942,440.293915 519.638184,430.730225 
	C528.379211,403.413544 537.004333,376.059753 545.675049,348.720551 
	C554.345703,321.381348 563.018188,294.042725 571.686646,266.702789 
	C580.452759,239.054901 589.236023,211.412445 597.970886,183.754684 
	C604.120239,164.283554 610.123413,144.766037 616.329895,125.313263 
	C627.165527,91.350975 638.032104,57.398045 649.074646,23.502752 
	C651.052917,17.430353 654.141785,11.679029 660.094116,8.483333 
	C665.249329,5.715566 670.687134,3.474102 676.000000,1.000003 
	C679.692932,1.000000 683.385803,1.000000 687.687622,1.357993 
	C697.039246,3.577138 704.607849,7.240062 709.637085,15.097368 
	C719.277466,30.158836 729.014221,45.158638 738.699036,60.191704 
	C751.904297,80.689240 765.085999,101.201927 778.300293,121.693604 
	C797.156250,150.933762 816.050964,180.148956 834.894592,209.397049 
	C851.094604,234.541901 867.221985,259.733582 883.425903,284.875916 
	C900.949463,312.065979 918.483276,339.249573 936.097046,366.381226 
	C943.359924,377.568695 949.968689,389.334442 958.412109,399.569153 
	C974.752686,419.376556 996.532532,428.900085 1022.228638,428.941406 
	C1033.157959,428.958984 1044.086426,428.135010 1055.018555,428.034607 
	C1100.278076,427.618774 1145.538818,427.324921 1190.799194,427.002502 
	C1239.059326,426.658783 1287.318970,426.236206 1335.579590,426.031433 
	C1372.742554,425.873749 1409.906494,426.000092 1447.070068,425.999939 
	C1454.911987,425.999908 1462.762939,425.760956 1470.593628,426.056824 
	C1481.177734,426.456696 1489.467041,431.574554 1494.908936,440.405548 
	C1498.030151,445.470245 1499.685059,451.438507 1502.000000,457.000000 
	C1502.000000,459.041656 1502.000000,461.083344 1501.646973,463.703949 
	C1501.066406,466.792023 1501.636719,469.785217 1500.462769,471.720062 
	C1496.841675,477.688171 1492.794434,483.440918 1488.474365,488.932526 
	C1480.478394,499.096802 1472.169312,509.014801 1463.994141,519.038269 
	C1454.473389,530.711426 1444.955444,542.387024 1435.438232,554.063049 
	C1428.613403,562.436157 1421.801392,570.819824 1414.965820,579.184204 
	C1405.429810,590.853088 1395.879761,602.510559 1386.331177,614.169067 
	C1378.234619,624.054626 1370.101807,633.910767 1362.039062,643.823730 
	C1352.644531,655.373840 1343.315308,666.977112 1333.945312,678.547363 
	C1325.605103,688.846191 1317.279907,699.157532 1308.890259,709.416077 
	C1299.345215,721.087402 1289.722046,732.694824 1280.159668,744.352173 
	C1273.411377,752.578979 1266.706665,760.841309 1259.985107,769.090027 
	C1250.572998,780.640564 1241.173340,792.201477 1231.749634,803.742554 
	C1223.873291,813.388550 1215.239014,822.511963 1208.229858,832.749634 
	C1193.335693,854.504333 1189.566284,878.404053 1197.955566,903.642029 
	C1244.448120,1043.508911 1291.067749,1183.333252 1337.582886,1323.192627 
	C1341.265015,1334.263550 1341.630981,1345.173706 1335.667725,1355.921509 
	C1328.741577,1368.404785 1312.395386,1376.066284 1298.482666,1371.987305 
	C1289.026123,1369.214966 1279.833496,1365.503906 1270.609619,1361.984619 
	C1246.232910,1352.683960 1221.880493,1343.318481 1197.561523,1333.867554 
	C1171.275391,1323.652222 1145.059082,1313.257080 1118.773193,1303.040894 
	C1094.758423,1293.707520 1070.672363,1284.558105 1046.653198,1275.236450 
	C1021.720642,1265.560303 996.850281,1255.723999 971.916748,1246.050659 
	C945.780273,1235.910645 919.587769,1225.915283 893.446167,1215.788574 
	C881.205139,1211.046631 869.208984,1205.207153 855.962158,1204.122925 
	C837.354492,1202.599976 819.774170,1206.399780 804.275879,1217.296265 
	C792.412415,1225.637207 780.844604,1234.398804 769.146912,1242.975342 
	C750.882629,1256.366455 732.585510,1269.713013 714.364746,1283.163086 
	C691.934631,1299.720093 669.597046,1316.402466 647.166382,1332.958740 
	C627.633972,1347.375732 608.006226,1361.663330 588.460083,1376.061768 
	C565.890259,1392.687378 543.362488,1409.370239 520.818848,1426.031494 
	C502.464417,1439.596558 484.292786,1453.418579 465.697571,1466.645020 
	C453.513977,1475.310791 442.781494,1486.326416 428.000000,1491.000000 
	C423.310760,1491.000000 418.621490,1491.000000 413.331299,1490.651489 
	C396.725494,1485.746826 385.476440,1472.628296 386.059357,1455.472168 
	C386.400330,1445.436279 387.363922,1435.422363 387.991516,1425.395142 
	C388.691803,1414.206177 389.364838,1403.015381 389.985229,1391.821777 
	C391.017151,1373.203979 391.979156,1354.582275 393.006805,1335.964111 
	C393.633820,1324.604248 394.355438,1313.249634 394.986572,1301.890015 
	C396.011719,1283.438477 396.977936,1264.983521 398.007263,1246.532104 
	C398.631683,1235.338745 399.363586,1224.151245 399.984039,1212.957642 
	C401.016083,1194.339844 401.973083,1175.717896 403.009186,1157.100220 
	C403.622833,1146.072876 404.378387,1135.053345 404.980255,1124.025391 
	C406.023590,1104.908325 407.041168,1085.789551 407.980835,1066.667114 
	C408.427460,1057.578125 408.629913,1048.477539 409.018524,1039.385376 
	C409.286285,1033.120361 409.284302,1026.807861 410.109070,1020.610474 
	C411.667450,1008.900330 411.812195,997.253235 408.932037,985.797791 
	C404.410858,967.815308 395.227173,952.663757 380.080811,941.591003 
	C364.700256,930.346924 349.172974,919.303467 333.697144,908.190063 
	C312.672974,893.092163 291.650055,877.992432 270.601288,862.928955 
	C252.988663,850.324585 235.323273,837.793945 217.710831,825.189392 
	C196.662216,810.125732 175.658798,794.998901 154.609970,779.935486 
	C136.997360,767.331116 119.331169,754.801575 101.718681,742.197021 
	C80.670151,727.133240 59.620747,712.070312 38.638077,696.915100 
	C29.252434,690.136108 19.712273,683.508850 10.872007,676.064758 
	C6.800891,672.636658 4.243669,667.410706 0.999994,663.000000 
z" />
        </svg>
      </div>
      <div className="absolute bottom-10 right-1/4 w-20 h-20 text-primary-foreground opacity-10 transform -rotate-12 pointer-events-none">
        <svg viewBox="0 0 1503 1492" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path fill="currentColor" d="M0.999994,663.000000 
	C1.000000,654.979065 1.000000,646.958191 1.367079,638.462708 
	C2.502623,637.243408 3.518604,636.631836 4.001655,635.733582 
	C9.439798,625.621216 17.701845,619.569946 28.931587,616.864014 
	C45.948551,612.763672 62.835785,608.121033 79.759155,603.637146 
	C105.609093,596.788269 131.434235,589.845825 157.286087,583.004272 
	C178.129517,577.488220 199.006027,572.097168 219.851471,566.588623 
	C245.705734,559.756409 271.533600,552.824219 297.390747,546.002991 
	C319.492981,540.172180 341.630341,534.474548 363.734192,528.649780 
	C389.751038,521.793884 415.728149,514.786682 441.761566,507.994720 
	C458.285431,503.683807 474.881348,499.703156 488.221344,487.982971 
	C497.447632,479.876953 505.352722,470.707794 509.916931,459.240448 
	C513.625549,449.922791 516.577942,440.293915 519.638184,430.730225 
	C528.379211,403.413544 537.004333,376.059753 545.675049,348.720551 
	C554.345703,321.381348 563.018188,294.042725 571.686646,266.702789 
	C580.452759,239.054901 589.236023,211.412445 597.970886,183.754684 
	C604.120239,164.283554 610.123413,144.766037 616.329895,125.313263 
	C627.165527,91.350975 638.032104,57.398045 649.074646,23.502752 
	C651.052917,17.430353 654.141785,11.679029 660.094116,8.483333 
	C665.249329,5.715566 670.687134,3.474102 676.000000,1.000003 
	C679.692932,1.000000 683.385803,1.000000 687.687622,1.357993 
	C697.039246,3.577138 704.607849,7.240062 709.637085,15.097368 
	C719.277466,30.158836 729.014221,45.158638 738.699036,60.191704 
	C751.904297,80.689240 765.085999,101.201927 778.300293,121.693604 
	C797.156250,150.933762 816.050964,180.148956 834.894592,209.397049 
	C851.094604,234.541901 867.221985,259.733582 883.425903,284.875916 
	C900.949463,312.065979 918.483276,339.249573 936.097046,366.381226 
	C943.359924,377.568695 949.968689,389.334442 958.412109,399.569153 
	C974.752686,419.376556 996.532532,428.900085 1022.228638,428.941406 
	C1033.157959,428.958984 1044.086426,428.135010 1055.018555,428.034607 
	C1100.278076,427.618774 1145.538818,427.324921 1190.799194,427.002502 
	C1239.059326,426.658783 1287.318970,426.236206 1335.579590,426.031433 
	C1372.742554,425.873749 1409.906494,426.000092 1447.070068,425.999939 
	C1454.911987,425.999908 1462.762939,425.760956 1470.593628,426.056824 
	C1481.177734,426.456696 1489.467041,431.574554 1494.908936,440.405548 
	C1498.030151,445.470245 1499.685059,451.438507 1502.000000,457.000000 
	C1502.000000,459.041656 1502.000000,461.083344 1501.646973,463.703949 
	C1501.066406,466.792023 1501.636719,469.785217 1500.462769,471.720062 
	C1496.841675,477.688171 1492.794434,483.440918 1488.474365,488.932526 
	C1480.478394,499.096802 1472.169312,509.014801 1463.994141,519.038269 
	C1454.473389,530.711426 1444.955444,542.387024 1435.438232,554.063049 
	C1428.613403,562.436157 1421.801392,570.819824 1414.965820,579.184204 
	C1405.429810,590.853088 1395.879761,602.510559 1386.331177,614.169067 
	C1378.234619,624.054626 1370.101807,633.910767 1362.039062,643.823730 
	C1352.644531,655.373840 1343.315308,666.977112 1333.945312,678.547363 
	C1325.605103,688.846191 1317.279907,699.157532 1308.890259,709.416077 
	C1299.345215,721.087402 1289.722046,732.694824 1280.159668,744.352173 
	C1273.411377,752.578979 1266.706665,760.841309 1259.985107,769.090027 
	C1250.572998,780.640564 1241.173340,792.201477 1231.749634,803.742554 
	C1223.873291,813.388550 1215.239014,822.511963 1208.229858,832.749634 
	C1193.335693,854.504333 1189.566284,878.404053 1197.955566,903.642029 
	C1244.448120,1043.508911 1291.067749,1183.333252 1337.582886,1323.192627 
	C1341.265015,1334.263550 1341.630981,1345.173706 1335.667725,1355.921509 
	C1328.741577,1368.404785 1312.395386,1376.066284 1298.482666,1371.987305 
	C1289.026123,1369.214966 1279.833496,1365.503906 1270.609619,1361.984619 
	C1246.232910,1352.683960 1221.880493,1343.318481 1197.561523,1333.867554 
	C1171.275391,1323.652222 1145.059082,1313.257080 1118.773193,1303.040894 
	C1094.758423,1293.707520 1070.672363,1284.558105 1046.653198,1275.236450 
	C1021.720642,1265.560303 996.850281,1255.723999 971.916748,1246.050659 
	C945.780273,1235.910645 919.587769,1225.915283 893.446167,1215.788574 
	C881.205139,1211.046631 869.208984,1205.207153 855.962158,1204.122925 
	C837.354492,1202.599976 819.774170,1206.399780 804.275879,1217.296265 
	C792.412415,1225.637207 780.844604,1234.398804 769.146912,1242.975342 
	C750.882629,1256.366455 732.585510,1269.713013 714.364746,1283.163086 
	C691.934631,1299.720093 669.597046,1316.402466 647.166382,1332.958740 
	C627.633972,1347.375732 608.006226,1361.663330 588.460083,1376.061768 
	C565.890259,1392.687378 543.362488,1409.370239 520.818848,1426.031494 
	C502.464417,1439.596558 484.292786,1453.418579 465.697571,1466.645020 
	C453.513977,1475.310791 442.781494,1486.326416 428.000000,1491.000000 
	C423.310760,1491.000000 418.621490,1491.000000 413.331299,1490.651489 
	C396.725494,1485.746826 385.476440,1472.628296 386.059357,1455.472168 
	C386.400330,1445.436279 387.363922,1435.422363 387.991516,1425.395142 
	C388.691803,1414.206177 389.364838,1403.015381 389.985229,1391.821777 
	C391.017151,1373.203979 391.979156,1354.582275 393.006805,1335.964111 
	C393.633820,1324.604248 394.355438,1313.249634 394.986572,1301.890015 
	C396.011719,1283.438477 396.977936,1264.983521 398.007263,1246.532104 
	C398.631683,1235.338745 399.363586,1224.151245 399.984039,1212.957642 
	C401.016083,1194.339844 401.973083,1175.717896 403.009186,1157.100220 
	C403.622833,1146.072876 404.378387,1135.053345 404.980255,1124.025391 
	C406.023590,1104.908325 407.041168,1085.789551 407.980835,1066.667114 
	C408.427460,1057.578125 408.629913,1048.477539 409.018524,1039.385376 
	C409.286285,1033.120361 409.284302,1026.807861 410.109070,1020.610474 
	C411.667450,1008.900330 411.812195,997.253235 408.932037,985.797791 
	C404.410858,967.815308 395.227173,952.663757 380.080811,941.591003 
	C364.700256,930.346924 349.172974,919.303467 333.697144,908.190063 
	C312.672974,893.092163 291.650055,877.992432 270.601288,862.928955 
	C252.988663,850.324585 235.323273,837.793945 217.710831,825.189392 
	C196.662216,810.125732 175.658798,794.998901 154.609970,779.935486 
	C136.997360,767.331116 119.331169,754.801575 101.718681,742.197021 
	C80.670151,727.133240 59.620747,712.070312 38.638077,696.915100 
	C29.252434,690.136108 19.712273,683.508850 10.872007,676.064758 
	C6.800891,672.636658 4.243669,667.410706 0.999994,663.000000 
z" />
        </svg>
      </div>
      {/* Bottom wave - Kept as static element */}
      <div className="absolute bottom-0 left-0 right-0 leading-none translate-y-px">
        <svg viewBox="0 0 1440 120" fill="none" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="none">
          <path d="M0,70 Q720,120 1440,70 V120 H0 Z" fill="white"/>
        </svg>
      </div>
    </section>
  );
};


